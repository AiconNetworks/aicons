Not so naive, gpt-enhanced bayes. Unifying Large Language Models and Bayesian Brain hypothesis.
Generative bayesian inference process using LLMs as experience in prior construction for statistically self-controlled decision making.

This is an attempt to create a Bayesian brain. We base our theory on the usage of system 1 and system 2 proposed by Daniel Khaneman and Amos Tverski assuming a similar approach taken by the brain through the aPFC and prefrontal cortex talked about in the book ‚Äúa brief history of intelligence‚Äù. In order for LLMs to have the system two approach we take an approach similar to what we see in bayesian brain hypothesis. Where the brain interpret the world in a way that resembles bayesian inference. In essence it proposes that brain combines prior beliefs (or expectations) with incoming sensory data to form a probabilistic estimate of the world.

The brain is not a yes/no basis. It represents information in terms of probabilities which allows for flexible interpretation when information is noisy or ambiguous.

At the heart of the hypothesis is Bayes theorm. When new sensory information is received, the brain update its internal model by weighting the new data (likelihood) against prior beliefs to form a revised belief (posterior).

Posterior = Likelihood x prior

Thr brain constantly makes prediction about incoming sensory signals. When the actual sensory input deviates form these predi ont a predicoint error is genertatd. This error is then used to update and refine the brains internal models, a process thought to be central to learning and adapataiton.

Perception
The bayesian approach helps explain how we interpret ambiguous sensory data. In visual peceiption our brains can resolve unclear images by integrating content and prior experiences. THis is why optical illusions or ambiguous figures can sometimes be seen in multiple ways.

Decision Making
In uncertain situations the brain weighs potential outcomes based on previous experiences and current sensory inputs. The probabilistic decision making process is a cornerstone of the Bayesian brain model.

Motor Control
When planning movements, the brian predicts the necessary motor commands by accounting for uncertainties in both sensory feedback and muscle responses. This predictive control helps ensure smooth and coordinated actions.

Regardless motor control not being paramount for our model creation aicons, we still need to acocunt that our instruments for empirical learning come from our limbs mostly. So this is something to have in mind when creating a complete bayesian agent.

Literature review
BAYESIAN INFERENCE
Incoming sensory data:
Every sensor has its context.
Right now sensors are api calls. So if looker renders dta that is incoming sensory data. If we talk with it then that is another sensor which will have different contextualization. But that is more application than logic.
Perception
The Bayesian approach helps explain how we interpret ambiguous sensory data. For example, in visual perception, our brains can resolve unclear images by integrating context and prior experiences. This is why optical illusions or ambiguous figures can sometimes be seen in multiple ways.
Decision-Making:
In uncertain situations, the brain weighs potential outcomes based on previous experiences and current sensory inputs. This probabilistic decision-making process is a cornerstone of the Bayesian brain model.

Neural Mechanisms
Distributed Coding:
Instead of having dedicated ‚ÄúBayesian neurons,‚Äù many researchers believe that probabilistic information is distributed across networks of neurons. Different regions of the brain might encode various aspects of uncertainty and prediction, contributing to an overall probabilistic computation.

Cortical Hierarchies:
The brain‚Äôs layered structure, especially in the cortex, seems well-suited to the Bayesian framework. Higher-level areas might integrate complex contextual information and expectations, while lower-level areas process raw sensory inputs, with ongoing feedback loops helping to update predictions.

L‚ÄôEsprit PreÃÅdictif : Introduction aÃÄ la TheÃÅorie du Cerveau BayeÃÅsien

Bayesian brain theory is based on predictive processing and suggest that brain encode beliefs to generate predicitns about sensory input. when sensory experiences differ from thes predictions the brain updates its beliefs accordingly.

Uses probabilistic beliefs to predict sensory
Updates these beleids based on prediction errors.
Uses bayesian math to adjust therse beliefs dynamically

The framework has computation models that somualte perception, decision making, learning and psychtiatric symptoms

perceptin is an unconsuons inference beased on hemrnan von helmholtz

The bayesian frameworks evlolecec form probability theory allowing thebrain to calculate the likelihood of sensory events and ajdjustebeliefs accordingly

General principles of pred itv processing

Beliefs probaiistic estimations of the world
hIerarchy, belieds are structured hierarchically in the brain
Predicion the brain constantly geenrates expectations
Prediciton eros, difference between predictions and sensory input
Belief updating adjusting beliefs based on errors
Precssion weightnig, the brain assings different levels of importance to differenc predictions and errso.

How it works:
Brain crates hypotheses about incoming sensory inforatio
Compares prediciotns to reality
Errors are sent up the hierarchy to refine future predictions

Likelihood of a perception is detmeied by past experiences (bayesbrainGPT, the memory or experience allocator is the large language model)

Action as prediction
brain predicts movements and updates predictions based on feedback
Acitve inference the brain acts to confirm its predictions
reflex aciotn, can be explained by prediciton errors triggereng immediate motor responses.

Emotion as predictor errors
ther brain predicrts internal bodily states
emomotion emegres when these predictions are VIOLATED
example fear occurs when encountering an unexpected danger, seeing a snake at hme. Triggering a sudden hear rate increase.

Intelligence and uncertainty: Implications of hierarchical predictive processing for the neuroscience of cognitive ability
This ‚Äúpredictive mind‚Äù thesis holds that the
whole of cortical information processing ultimately serves to (1) implement and dynamically adjust a hierarchy of predictions about the
organism‚Äôs expected sensory inputs and internal states, (2) estimate and
tune the precision of those predictions, and (3) continuously minimize
the resulting ‚Äúerrors‚Äù or violations of those predictions, which arise
through environmental changes and the organism‚Äôs actions upon its
environment

In particular, it is argued that in the process of minimizing prediction errors, the brain implicitly minimizes the organism‚Äôs likelihood of finding itself in phenotypically unexpected (and thus probabilistically maladaptive) states, thereby making environmental prediction the key way that organisms maintain homeostasis

Frequentist and Bayesian Statistics Explained
Bayes is subjective probability
rules: probability cannot be divorces form background information
background information can be represented on donctionl probability
This include subjective beliefs but also data, research and experiences.
X is all the background information someone has about an event.
Probability that an event A happes is condiitined on X. X is represented in beliefs that they have other priors embedded inside the abstract representation of that belief.
If two people have same X, then P(A | X ) = P(A | X¬¥)
So we are using the logical interpretation of probability; bayesian probability = logical interpretation

For bayesian analysis we need two things:
Likelihood of data
beliefs in term of a prior
Assumptions
We think that rather to store values in memory we can compute priors and update priors as we go along. This way we can do continuous learning through bayesian interpretation of actions.

We assume through bayesian brain hypothesis that the bayesbrainGPT builds probabilistic models that can explicitly represent dependencies, covariances and interaciotns among variables. We handle precision
We handle covariance and interrelations of factors by using precision precision adn incertany and modeling it as a hierarchical model .This would allow higher level priors rto capture global dependences. Fore example a high-level model might encode typical weather patterns taht affect multiple lower-level variables like temperature , humidity and rain.

The brain might encode this uncertainty using population codes, where neural activity patterns reflect variance (uncertainty about a single variable) and covariance (how two variables relate). Since we are using llms as proxy of experience data storage similar to what the brain does, we are going to assume this encoding as well for now.
State representation
Brain develops priors over time based on past experiences and learned regularities about the world. These priors act as a framework for interpreting new sensory input. Large language models have many priors embedded in their language. In order for LLMs to autocomplete the following words, they will do so by probabilistically choosing the best token until it reaches a stop. Language gotten from the internet has priors embedded in it. When we say, or type something we do it based on our assumptions. Having the experience of the whole internet, we could benefit from these priors or factors for decision making. Then these pre=existing expectations are used by the brain to make sense of the incoming sensory data.

Pros: The good thing about using a language model is that there is practically nothing the large language model doesn‚Äôt know. Like it can make decisions for almost everything. This is because it has all our knowledge.

Cons: They are overly general. Since they are probabilistic and just use argmax of the best token, they don't take into account all the other possibilities that could be. LLMs on their own do not have the possibility to ‚Äúthink‚Äù of other outcomes. We handle this currently by telling the llm to think in steps, or think before answering (Chain of thought).

Here we propose a different ‚Äúthinking‚Äù methodology. This is by thinking hierarchically.

We have first the theory of how this works and later how we integrate it in the aicon system.

Theory:

Integration:
The integration is a little bit more complicated. This is due to how large language models operate. We cannot just tell the large language model to create priors and distributions based on the task in hand. Rather we need to let the LLM to continue generating tokens normally, maybe using a chain of thought approach. Then we have to extract the priors and values from the generation. This because depedning on the prompt, the mllm will take those works form us and bias the system towards conitnuinng from that prompt. I.E. if we give the prompt ‚Äúbased on this text {text} give me the priors and distributions of those priors‚Äù Instead of the model being biased towards a embedding space related to what the text is about, it is going to be biased towards what priors are about. The problem is that in the internet the priors information would be more statistical which could bias the system to use values that are related to infromartion closer to statistics rather than based on the text. This is also an assumption. More research has to be done in how the embedding of a word changes during the lifespan of the window context self-attention mechanism.

In the bayesian brain hypothesis, the brain is thought to have higher cortical areas which encode abstract, high-level expectations like ‚Äúits stormy‚Äù,; it has lower cortical areas which process sensory details, like local rain intensity. And it has feedback looks that carry precitns form higher levels to lower levels and send back errors signals when prec iotns dont match sensory input.

In our system, state representation is also the place where the system makes assumptions of data. These are latent variables.

Latent Varibales
For example we can assume there is a true temperature Ttrue that we want to infer. We dont observe Ttrue directly; instead we get a measurement of Tobs that is noisy.
Then we get measurement model (likelohood)

Tobs‚Äã=Ttrue‚Äã+œµT‚Äã,
where œµT‚Äã‚àºN(0,œÉT2‚Äã)

Thenw e specify a prior for Tture, for instance if we expect the temperature typically hovers around 25 witha astandar deviation of 5 we could define

Ttrue‚Äã‚àºN(25,52).

This is the prior belief before seeing the current observation. This is also where we can leverage large language models experience for prior modeling.

So even though temperature is coninoulsy observed, we predefine it by assuming a generative process: thre is a latent Ttrue that geenrates teh observed Tobs via noise.
Specifying a prior for Tture; this ecnodes initial belief about temperature before new data.
Incorporating measurement uncertainty: Through the noise model œµT‚Äã‚àºN(0,œÉT2‚Äã).

Factors

In a bayesian framework, state s captures all relevant aspects of the environment and/or internal conditions that influence decisions.

Philosophically, what we catch through our senses might trigger some action or decision making process. This is a bottom-up decision making situation.

They can be discrete variables, have a finite set of possible values.
Examples:
Weather: sunny, cloudy, rainy
Traffic: light, moderate, heavy

Continuous variables:
rain amount
temperature
speed

In the bayesian brain perspective the model already holds some internal representation of how these factors behave or co-vary.

These are hypotheses or explanatory variables that could account for variations in features F.
Defining factors
List factors
Expectations

You might expect that ‚ÄúRain amount‚Äù is typically low in certain seasons, high in others.
You might expect that ‚ÄúHeavy traffic‚Äù is more common at 5‚ÄØPM than at 2‚ÄØPM.

Specify their internal structure:

In the example of rain, we could use a linear model for r.

r=Œ∏ 0 ‚Äã +Œ∏ 1 ‚Äã x 1 ‚Äã +Œ∏ 2 ‚Äã x 2 ‚Äã +Œ∏ 3 ‚Äã x 3 ‚Äã +Œ∏ 4 ‚Äã x 4 ‚Äã +Œ∏ 5 ‚Äã x 5 ‚Äã +œµ

In a bayesian framework we treat these parameters as Random Variables with their own prior distributions:

Œ∏i‚Äã‚àºP(Œ∏i‚Äã)

Continuous Variables in bayesbrainGPT
Variables that can take any value in a range.
Example: Rain amount (in mm), temperature (in ¬∞C)
Probability Density Function
Often modeled with gaussian distribution

For rain we have r = theta0 + theta1\*x1 ... + e, e ~ N(0, sigma^2)

Conditionally, r is normally distributed with a mean given by the linear combination and variance sigma squared.

If its like temperature we introduce a latent variable. So we assunem there is a true temperateuer T_true that we want to infer. We dont observe T_true directly instead we get a measurement of T_obs that is noisy. So we model teh observed temperature as T_obs = T_true + e_T, where E_T = N(0, sigma^2_T). This says that the observed alue is drawn from a nrmal distribution centerd at T true with some measuemrnt error sigma T.
Assign Priors
We assign priors to any parameters involved. Also we might have hyperprios. Hyperpriors are for hyperparamers. So we assign priors to miu, sigma . They control the mean and variance of the prior distribution of theta. They deteimene how spread out or concentrated the distribution fo lower level parameters is. THey also capture aborerder expectations or uncertainteies about the parameters that govern the behavior of the system.

we specify a prior for Ttrue which might be 25 with standardd eviation of 5 ; then that is ourprior belief before seeing the current observation.

Discrete Variables in bayesbrainGPT
Variables that take on a countable set of values.
Example: Number of cars passing a street per minute, or the state of a switch (on/off)

Probability Mass Function (PMF)
If we have a discrete variable d, we might assume a Poisson distribution.

Priors
If discrete variable is part of a larger hiercahcial model we migh specify hyperparemeters that control its distribution,

Monte Carlo simulation
We had an issue using NUTS and HMC in general because nuts is a continuous inference algorithm, so it requirese all latent variables to be coninupus and differentiable. In our model we are going to have variables like weather and these acan be discrete due to how the LLM creates them. Instead of using NUTS we could use sequential monte carlo, that can naturally handle discrete variabesles, Or we can use discrete friendly MCMC. The trade off is that can be less efficient or require more tuning.

Categorical Variables in bayesbrainGPT
Variables that represent categories or labels which may not have a natural numeric ordering.

Categorical Distribution (or Multinomial if multiple outcomes)
P(w = Clear) = 0.4, P(w = Cloudy) = 0.4, P(w = rainy) = 0.2

Priors and hierarchy
We might have a hierarchical model where the probs are drawn from a dirichlet prior, allowing the system to learn or adjust these probs over time. Example latent dirichlet allocation.
Prior Distribution P(s)
Mathematically we can use a function (or a set of functions) encoding what the brain believes before seeing new evidence.

For mixed discrete/continuous states it can be a joint distribution.
It has probability mass (pmf)
It has probability density (pdf)

For purely discrete
Categorical distribution

For purely continuous
We can have a gaussian.
Other continuous prior.

Identify the objective and context
Objective what is the end foal of the model?
Context which aspects of weather are most relevant?

So for example, programming campaign ads.

List potential factors
Catgeroical variables, continuous, discrete
Decide on the internal structure
We eed to check how factors might be interrelated.
Hierarchical Relationships
Conditional Dependencies
Contextual Variations
Assign priors and hyperpriors

For each variable or parameter in the conditional distribution, we need to choose an appropriate prior distribution. The hyperparameters of the priors can reflect export knowledge or historical data.

Retrieval / Memory
In a biological Bayesian brain, these priors are shaped by experience‚Äîi.e., memory of past patterns. Think of it as a long-term representation that you ‚Äúretrieve‚Äù whenever you need to infer or predict current conditions.

In our BayesbrainGPT, they are stored in neural nets in a transformer like architecture.
Modeling Structure:
Decide whether to define a single joint distribution over all factors or to use a hierarchical model that factors the joint distribution into manageable conditional components.

Hierarchical model
In the bayesia brain hypothesis evidence suggest that the brain uses a hierarchical generative model.

Top down predictions
Higher corical areas generate predictions about what teh sensory input should be

Bottom0up error signals
Lower level sensory areas compare actual input with these prediciots sending back errors that help update th emodel

Learning and Adaptation:
This layered structure allows the brain to learn and update its beliefs at multiple levels, from raw sensory data to abstract concepts.

Problems when defining factors
Model Complexity
Each additional factor adds complexity. In a Bayesian setting, the joint distribution P(s)P(\mathbf{s})P(s) can blow up combinatorially if you have many discrete categories or multi‚Äêdimensional continuous variables. Balancing completeness (lots of variables) vs. tractability is part of the design

Relevance to Decisions
Usually, you pick variables that meaningfully impact your utility function or your predictions. If wind speed doesn‚Äôt change your decisions, maybe you skip it.

Categorical problems
Soltuion: One hot encoding

Discrete problem
Sincew we are using NUTS. We cannot use direct discrete variables in our maode so what we do is relation of factors wechih allow for usng themas continueposu variables. We need to determine a amtreco tp understand if this is wokeign orn not.

Relationships
The brain uses top-down prdcitions to infer sensory outputs. If you know from your past experience that heavy storms typically bring hight rain and lower temperata your model can predict what sensory data should look like. When the actual data deviates the predciotn error informs an update of a humans beliefs.

Relatinsohp can hep explain away correlated bariabilty. If two variables tend to co-vary liek temp adn rain storme, mdoeling their relaiosps reduces redundancy and improves inference.

Learnign and adaptations, I father erleaitonshop between weather and traffic changes, system can update its model accordingly. This is important because mandy prediction models before covid were awful predicting during coivd and even after covid.

Example: Modeling Weather and Related Factors
Let the overall state be
s=(r,T,œâ,d),\mathbf{s} = (r, T, \omega, d),s=(r,T,œâ,d),
where:
rrr (Rain Amount): A continuous variable (in millimeters).

TTT (Temperature): A continuous variable (in ¬∞C).

œâ\omegaœâ (Weather Type): A categorical variable with levels, for example, {Clear,Cloudy,Stormy}\{\text{Clear}, \text{Cloudy}, \text{Stormy}\}{Clear,Cloudy,Stormy}.

ddd (Number of Traffic Incidents): A discrete variable (non-negative integer) that might depend on the weather.

Hierarchical Factorization
Instead of specifying one flat joint distribution P(r,T,œâ,d)P(r, T, \omega, d)P(r,T,œâ,d), we can factorize it to reflect the dependencies we believe exist:
P(r,T,œâ,d)=P(œâ)‚ÄÖ‚ÄäP(T‚à£œâ)‚ÄÖ‚ÄäP(r‚à£T,œâ)‚ÄÖ‚ÄäP(d‚à£œâ).P(r, T, \omega, d) = P(\omega) \; P(T \mid \omega) \; P(r \mid T, \omega) \; P(d \mid \omega).P(r,T,œâ,d)=P(œâ)P(T‚à£œâ)P(r‚à£T,œâ)P(d‚à£œâ).
Explanation of Each Term
P(œâ)P(\omega)P(œâ) ‚Äì Weather Type (Categorical):
This is the top-level prior. For example, we might assume:
P(œâ=Clear)=0.5,P(œâ=Cloudy)=0.3,P(œâ=Stormy)=0.2.P(\omega = \text{Clear}) = 0.5,\quad P(\omega = \text{Cloudy}) = 0.3,\quad P(\omega = \text{Stormy}) = 0.2.P(œâ=Clear)=0.5,P(œâ=Cloudy)=0.3,P(œâ=Stormy)=0.2.
P(T‚à£œâ)P(T \mid \omega)P(T‚à£œâ) ‚Äì Temperature Given Weather (Continuous):
Temperature depends on the weather type. We might model this with a Gaussian distribution whose parameters (mean and variance) depend on œâ\omegaœâ. For instance:
T‚à£œâ=Clear‚àºN(ŒºClear,œÉClear2),T \mid \omega = \text{Clear} \sim \mathcal{N}(\mu*{\text{Clear}}, \sigma*{\text{Clear}}^2),T‚à£œâ=Clear‚àºN(ŒºClear‚Äã,œÉClear2‚Äã), T‚à£œâ=Cloudy‚àºN(ŒºCloudy,œÉCloudy2),T \mid \omega = \text{Cloudy} \sim \mathcal{N}(\mu*{\text{Cloudy}}, \sigma*{\text{Cloudy}}^2),T‚à£œâ=Cloudy‚àºN(ŒºCloudy‚Äã,œÉCloudy2‚Äã), T‚à£œâ=Stormy‚àºN(ŒºStormy,œÉStormy2).T \mid \omega = \text{Stormy} \sim \mathcal{N}(\mu*{\text{Stormy}}, \sigma*{\text{Stormy}}^2).T‚à£œâ=Stormy‚àºN(ŒºStormy‚Äã,œÉStormy2‚Äã).
The parameters Œº\muŒº and œÉ2\sigma^2œÉ2 here can themselves have hyperpriors reflecting our higher-level uncertainty.

P(r‚à£T,œâ)P(r \mid T, \omega)P(r‚à£T,œâ) ‚Äì Rain Amount Given Temperature and Weather (Continuous):
The amount of rain might depend both on the weather type and the temperature. Again, we can model rrr as Gaussian:
r‚à£T,œâ‚àºN(Œ∏0(œâ)+Œ∏1(œâ)‚ÄâT,‚ÄÖ‚ÄäœÉr2(œâ)),r \mid T, \omega \sim \mathcal{N}(\theta*0(\omega) + \theta_1(\omega)\, T,\; \sigma_r^2(\omega)),r‚à£T,œâ‚àºN(Œ∏0‚Äã(œâ)+Œ∏1‚Äã(œâ)T,œÉr2‚Äã(œâ)),
where the regression coefficients Œ∏0(œâ)\theta_0(\omega)Œ∏0‚Äã(œâ) and Œ∏1(œâ)\theta_1(\omega)Œ∏1‚Äã(œâ) and the variance œÉr2(œâ)\sigma_r^2(\omega)œÉr2‚Äã(œâ) are specific to the weather type œâ\omegaœâ.
‚Äì Hyperpriors can be placed on these coefficients (e.g., Œ∏1(œâ)‚àºN(ŒºŒ∏1,œÑŒ∏12)\theta_1(\omega) \sim \mathcal{N}(\mu*{\theta*1}, \tau*{\theta_1}^2)Œ∏1‚Äã(œâ)‚àºN(ŒºŒ∏1‚Äã‚Äã,œÑŒ∏1‚Äã2‚Äã)).

P(d‚à£œâ)P(d \mid \omega)P(d‚à£œâ) ‚Äì Number of Traffic Incidents Given Weather (Discrete):
Traffic incidents might be more frequent in bad weather. We can model ddd with a Poisson distribution:
d‚à£œâ‚àºPoisson(Œª(œâ)),d \mid \omega \sim \text{Poisson}(\lambda(\omega)),d‚à£œâ‚àºPoisson(Œª(œâ)),
where Œª(œâ)\lambda(\omega)Œª(œâ) is the expected number of incidents given the weather type. Hyperpriors could also be placed on Œª(œâ)\lambda(\omega)Œª(œâ) if desired.

Perception

NUTS with continuous relaxation
NUTS can be applied without having to enumerate discrete sites.
Update prior to a posterior.

Defining likelihood functions
It specifies how probable the sensor observations are given the satet factors. So if we have a sensor that measures temperature with known noise charactresiitfcs we would model that using a normal likelihood. With a mean equal to the true tmeprateuer and a viarbance that reflects senors noise.

We need to check also what the sensors data mean. How can we define how much data are we going to pull from the senor. Here is where we can add statistical quality control and alerts. We are going to monitor the sensor dpedning on previous data to see the variance of the data.

Here is where we might use bayes factor to determine how hypotheses turn into posterieors when we dont have sensorial data.

---

In bayesian brain hypothesis, perception is applying and updating priors rather than creating them from scratch.

When brain receives sensory input, it doesnt start from zero. It applies pre existing expectations to the new information.

Combining with New Evidence:
In a Bayesian framework, this process is mathematically similar to multiplying the prior (what you expect) with the likelihood (what the new data suggests) to produce a posterior probability (an updated interpretation of the scene). Essentially, your brain is weighing the new evidence against what it already knows.

Sources of information
This is typically done by assigning each source its own uncertainty or variance.
Likelihood Functions with Uncertainty:; For each source, you model the likelihood function. A direct sensory observation might have a narrow likelihood (low variance), meaning it's very precise. In contrast, someone‚Äôs verbal report might have a wider likelihood (higher variance), indicating less certainty about the exact amount or occurrence of rain.
In Bayesian statistics, the reliability of a measurement is often expressed as its precision, which is the inverse of the variance.

Priors
We have layers of priors, our assumption is that llms can also express this.
So we have nested priors. Like we have a prior belief because we have a prior belief because we have a prior belief. These are not hyperpriors but rather hierarchical model.
BayesianGPT Brain
We assume here that LLM will utilize the knowledge it has to create the priors. Then we can see later if we break down a prior into other priors.
We are going to use abstraction of priors, then we can break these priors into derived priors.
Retrieval comes naturally from setting the problem. We set the problem by using sensoor context and uncertainty of sensor.
Feature extraction
Raw sensor data is processed an transformed into more meaningful features.
Onece features are extracted they can be integrated with prior knowledge.

Forming the likelihood

BayesianGPT Brain
Large language model has already accumulated knowledge about the internet, proxy of human informaion, proxy to a world model.
We can assume that all information is soteed somehow in neural nets where we use linguistics to articulate them.  
Forming the likelihood here might be creating the likelihood of the real data we have.
For example in the ads scenario, the real data its what we are trying to predict.

During perception, in state updating with posterors, we can have some metrics that will help towards automatically understanding the state of the system.
Acceptance Rate
A lower acceptance rate means the system is being more conservative and explornig more of the uncertainty.
Beliefs Update

We are always processing data but for a specific situation we have to filter out noise. Since we are multi-purpose, our system is based on priorities. In our case we are creating first unipurpose agents. This is because we can easily engineer sensorial channels with uncertainty and context.

For posterior, we use Hamiltonian Monte Carlo
What is hamiltonian monte carlo and how does it apply in our system?
HMC uses gradients and hamiltonina dynamics to propose new states that are likely to have high probailiyt unders the new posterior distribuoin. An acceptance rate aroun 60% suggest that the proposals are either too conservative, which would result in a very high acceptance rate but slow exploration, nor too aggressive which would lead to too many rejectinos. It indicate that your sampler is effectively navigating the posterior landscape.
The sampler avouds proposing impossible scenarios suc as having more clicks than impression because likelihood and prior together enode those contrsins.

A moderate acceptance rate indicates a good balance between exploring the parameter space and converging to the true posterior distribution. If acceptance rate was extremely low, it might signal taht step sizes or energy estimates are off. Meaning most proposed states are highly unlkley under the model. Conversely an extremely high acceptance rate coils imply that the sampler is taking very small steps which might slow down convergence and redue the efficiency of exploration.

An acceptance rate of 59.20% proposes new states that are reasonable given hierarchical model for the ad data.

What are states?
A state is a compete specificainon of all the latent variablesin the model at a given moment. One possible confirmation or snapshot of the entire models internal beliefs.

HMC uses a Metropolis acceptance criterion to decide whether to move to the new state or stay at the current one.
Earache state is represented by position q, and momentum p. H(q, p) is defined as the sum of:
Potential energy
Kinetic energy

When we run HMC it proposes new configurations for the latent variables. Then the acceptance criterion ensures consistency with joint distribution. And maintains constraints, e.g. if the new state would imply more clicks than impressions, the energy H(q) would be very high, making deltaH large and the proposal very unlikely to be accepted (Because is impossible to have more clicks than impressions).

"under your model" refers to the joint distribution (the complete probabilistic model) that you've specified. This joint distribution encapsulates all your assumptions (priors, likelihoods, hierarchical relationships) about how the world works according to your model, and it‚Äôs used to judge whether a new proposed state is plausible or not.

Why This is Useful for Decision-Making
Captures Uncertainty:

Instead of relying on a single estimate, we get a distribution for each metric.

This allows for better risk assessment.

Maintains Relationships Between Metrics:

Since HMC samples the joint posterior distribution, it respects natural constraints (e.g., clicks cannot exceed impressions).

Combines Campaign-Level and Ad-Level Performance:

HMC allows hierarchical modeling, meaning both high-level trends (campaign-level) and detailed ad performance (per-ad metrics) are captured simultaneously.

Sensorial Data
In the Bayesian brain hypothesis, sensorial data continuously flow in, whenever there is a change in environment, the system gathers the latest sensorial data and uses it to update its beliefs about the state of the world. This update is Bayesian inference and it happens before a decision is made.

Here is where we can introduce control charts. Factors will have random noise but when we have an alert, at that time there has to be an update of beliefs or an environment analysis.

Sensors
We can use SQC for unexpected variation in sensorial data. This allwows the bayesian brain to analyze the situation

OKay this is intereting the thign is that we need to define sensors in a way that can be used correclty so lets first define sensors. Sensors are the packests of information, coming in discrete, conitnuous or categorical way which have a level of trust. For example in human system, our eyes are trutsful because they are integrated to the brain. It is not third party information. But a story told by a stranger might not be atrustful source. Actually this is weird becasue we still are hearing it so it should be trsutful. sO INT THIS CAE THE WORDS ARTE TRUSTufl because we are hearing them but th einformation might not be. so basically sensors connected to our system are trsustuful but the infromation channel might not be. To make it easier for now we are just going to measure information trust because we are buidling the sensors so they should be trustuful connections.

So are we using like interfaces? So thta we define a sensor and then we could have many types of snesors. A sensor can get infromation. A sensor can send information a sensor has a reliability score. The get infroatino si from the sorufce. so FOR exmaple a wetahter sensro could eb an api. The get information is so that the bayes brain calls the sensor for informairon. thE SEND infromation is that the sensor is sedning infor to the brain. These are different because a brain might want to do something with infromarion that is "encountering" so it is seeking for informaiton or sensorial data migh tjust be flwoing to the brain.

Sensor Examples
Meta marketing campaign data.

Action space
Defining the action space.
In this step we set the actions available to the decision maker. The actions are determined by practical constraints and top-down considerations.

Why top down?
Top-down considerations
ACtion space is defined by our practical abilities and constraints, while our state might include that birds fly and they take less time transporting we should restrict our action space to car and walk because we are constrained/capped by human capability. Unless we have a alken or a bike. This is very interesting because top down considerations are created based on external factors, like tools. These restrictions are imposed externally by design.

Here also would be a perfect spot for policy making.

---

It can be generated bottom-up or top-down.

Action space can be predefined. Like in connections where the game has a predefined decision space. Or in our case we can determine beforehand what the options are and then we analyze towards what is the better choice.

Matrix A.

Choose the action with the highest expected utility.

BayesianGPT Brain
We can use predefined actions we have
Actions space can be pre-generated, generated purely with LLMs, or generated with isolated system data.
Like in physics we need to define what is part of the system and what isnt. Information thermodynamics.

Constraints and Feasible Action Space:
Extrinsic goals may also limit the action space. In a company, you might not have the option to pursue strategies that are too risky or deviate from the brand‚Äôs identity. This means the set of actions AAA is defined not only by what is physically or technically possible but also by organizational or regulatory constraints.

Cursor/ Claude3.7 ->

Yes ebcause wee are trying to define a general action space righ? So if we say that the only one is google.... then 1000 is going to go there I mean we can do teh whole computation but we are still goign to decide that. The onoly thing is taht with teh whoel cojmputaiotn we might have teh uncertainty of whetere we are cool with it or not
Ah, now I REALLY get what you're saying!Yes, exactly! The action space is general - it could be:
Just Google (1D: all 1000 to Google)
Google + Facebook (2D: split between them)
Google + Facebook + Twitter (3D: split between three)
etc.
The scalar tensor we're getting is actually fine because:
It represents a single decision point in whatever dimension space we have
The uncertainty comes from our posterior samples about conversion rates, costs, etc.
The utility computation helps us decide if we're "cool with" that allocation given our uncertainty
So I was wrong to try to force 2D - the scalar tensor is actually the right representation of a single decision point, regardless of how many dimensions our action space has.The real issue must be in how we're handling the utility computation itself. Should we look at that?

Is it good that action space is entirely separated from decision? maybe based on
Utility Function
This quantifies the goodness or value of taking action given a particular state s. S can include factors like rain which is linear bayesian, temperature continuous and traffic discrete.

Specifying Utility Function
The utility function typically combines several components such as:
Base benefit: How desirable an action is independent of weather (e.g. convenience of driving)
Rain penalty: The negative impact of rain on the action (discomfort if you don't have an umbrella)
Temperature or other factors: Additional adjustments based on temperature comfort, etc.

Example:
4.2 Mock Values for Each Component
Assume the following for our four actions:
Base Benefit B(a,œÑ)B(a, \tau)B(a,œÑ)
Suppose that for a departure at 6‚ÄØPM:
For Car:

With œÑ=Light\tau = \text{Light}œÑ=Light: B(Car, _)=90B(\text{Car, _}) = 90B(Car, \*)=90 if you have an umbrella, and 959595 if you don‚Äôt (perhaps because carrying an umbrella is slightly inconvenient when driving).

For Walk:

B(Walk, _)=80B(\text{Walk, _}) = 80B(Walk, \*)=80 regardless of traffic (walking is less affected by traffic conditions).

(Here ‚Äú‚àó\*‚àó‚Äù means that for now, we assume traffic is fixed by our state estimate.)
Rain Penalty Œ±(a,r)\alpha(a, r)Œ±(a,r)
Define a linear penalty in rrr (which is predicted from our Bayesian linear regression):
For Car, Umbrella: Œ±(Car, Umbrella,r)=0.2√ór\alpha(\text{Car, Umbrella}, r) = 0.2 \times rŒ±(Car, Umbrella,r)=0.2√ór.

For Car, No Umbrella: Œ±(Car, No Umbrella,r)=0.5√ór\alpha(\text{Car, No Umbrella}, r) = 0.5 \times rŒ±(Car, No Umbrella,r)=0.5√ór.

For Walk, Umbrella: Œ±(Walk, Umbrella,r)=0.3√ór\alpha(\text{Walk, Umbrella}, r) = 0.3 \times rŒ±(Walk, Umbrella,r)=0.3√ór.

For Walk, No Umbrella: Œ±(Walk, No Umbrella,r)=0.8√ór\alpha(\text{Walk, No Umbrella}, r) = 0.8 \times rŒ±(Walk, No Umbrella,r)=0.8√ór.

Temperature Penalty Œ≤(a,T)\beta(a, T)Œ≤(a,T)
For simplicity, assume that temperature mainly affects walking:
For Car: Œ≤(Car, _,T)=0\beta(\text{Car, _}, T) = 0Œ≤(Car, \*,T)=0 (climate control in cars makes temperature irrelevant).

For Walk:

If T=25T = 25T=25¬∞C: Œ≤(Walk, _,T)=2\beta(\text{Walk, _}, T) = 2Œ≤(Walk, \*,T)=2 (slightly warm, but tolerable).

If T=15T = 15T=15¬∞C: Œ≤(Walk, _,T)=1\beta(\text{Walk, _}, T) = 1Œ≤(Walk, \*,T)=1 (cooler, slightly more comfortable).

4.3 Putting It Together
For example, consider state s = (r = 15\,\text{mm},\; T = 25\,^\circ\text{C},\; \tau = \text{Light}):
For a1=a_1 =a1‚Äã= (Car, Umbrella):
U(a1,s)=90‚àí(0.2√ó15)‚àí0=90‚àí3=87.U(a_1, s) = 90 - (0.2 \times 15) - 0 = 90 - 3 = 87.U(a1‚Äã,s)=90‚àí(0.2√ó15)‚àí0=90‚àí3=87.
For a2=a_2 =a2‚Äã= (Car, No Umbrella):
U(a2,s)=95‚àí(0.5√ó15)‚àí0=95‚àí7.5=87.5.U(a_2, s) = 95 - (0.5 \times 15) - 0 = 95 - 7.5 = 87.5.U(a2‚Äã,s)=95‚àí(0.5√ó15)‚àí0=95‚àí7.5=87.5.
For a3=a_3 =a3‚Äã= (Walk, Umbrella):
U(a3,s)=80‚àí(0.3√ó15)‚àí2=80‚àí4.5‚àí2=73.5.U(a_3, s) = 80 - (0.3 \times 15) - 2 = 80 - 4.5 - 2 = 73.5.U(a3‚Äã,s)=80‚àí(0.3√ó15)‚àí2=80‚àí4.5‚àí2=73.5.
For a4=a_4 =a4‚Äã= (Walk, No Umbrella):
U(a4,s)=80‚àí(0.8√ó15)‚àí2=80‚àí12‚àí2=66.U(a_4, s) = 80 - (0.8 \times 15) - 2 = 80 - 12 - 2 = 66.U(a4‚Äã,s)=80‚àí(0.8√ó15)‚àí2=80‚àí12‚àí2=66.
(These are example values for one particular state.)

IN bayesian brain hypothesis, te utility not typically and explicit symbolic function that is calculate das in fomral decision model. It is thought to emege form natural processes that assign value to outocems. For example brain regions like the orbitofrontal cortex and ventromedial prefrontal cortex are involved in evaluating rewards and costs and their activity reflects what we might think of as utility,

In our bayesbrainGPT system, the utility function could be inferred from the language model. But same as humans in workplaces, utility function could have constraints imposed by the environment or organization. Again we could also give the power for the llm to determine the constraints based on organization information. Or we can constraint it by defining a utility function. Fore example in marketing, the decision of which add to select is based purely on sales. so that is what the function include.

Computing Expected Utility for each action
We combine our updated beliefs about the state with th eutilyt function to compute the expected utility (EU) for each action.

So expected utility for action a is given by:
EU(a)=‚à´s‚ÄãP(s‚à£Data)U(a,s)ds,

or in discrete approacimation over our state space s:
EU(a)=s‚àë‚ÄãP(s‚à£Data)U(a,s).

For example, when you're working for a company, your actions might be constrained by corporate strategy, resource limits, or regulatory requirements. In such a case, your utility function would reflect extrinsic goals, such as maximizing company profits, adhering to brand guidelines, or meeting sales targets. This differs from a scenario where you‚Äôre free to choose your actions without those external constraints.

Shaping the Utility Function:
The utility function can explicitly include terms for external objectives. For example, a marketing analyst might define:
U(Ad)=Expected Revenue‚àíCost+Œª‚ãÖBrand Impact,U(\text{Ad}) = \text{Expected Revenue} - \text{Cost} + \lambda \cdot \text{Brand Impact},U(Ad)=Expected Revenue‚àíCost+Œª‚ãÖBrand Impact,
where Œª\lambdaŒª adjusts the weight of long-term brand value‚Äîa goal imposed by the company.

Decision Making
Bayesian Brain: Decisions emerge from neural computations that weigh rewards, costs, and uncertainties, often implicitly via dopamine and other reward signals.

Both approaches share the same principle: actions (or choices) are evaluated based on their expected outcomes, and the one with the highest ‚Äúutility‚Äù (whether computed neurally or mathematically) is selected.

Actions
We do expected utility for 2. Integrating Action Space with the Posterior
For each action aaa in your action space:
Step 1: For every posterior sample sis_isi‚Äã (which represents one possible configuration of latent parameters), compute the utility U(a,si)U(a, s_i)U(a,si‚Äã).

Step 2: Average these utility values over all NNN posterior samples:
EU(a)‚âà1N‚àëi=1NU(a,si).\text{EU}(a) \approx \frac{1}{N} \sum\_{i=1}^{N} U(a, s_i).EU(a)‚âàN1‚Äãi=1‚àëN‚ÄãU(a,si‚Äã).

Then we do argamx of the one that has the best utlut. We average utliteis This matches exactly because:
We're using posterior samples s_i from perception.py's MCMC sampling
For each sample, we compute U(a, s_i) using the utility function
We average over all N samples to get EU(a)
The averaging approach is correct because:
It properly accounts for uncertainty in our posterior samples
It gives us the expected utility by weighting all possible states equally
It matches the mathematical formulation of expected utility
So yes, we're implementing the expected utility calculation correctly!

Learning
Updating priors also come from understanding what actions were made. We can use large language models with help of humans, purely with humans, or purely with LLMs.
Problems
In bayesian updating ucnetainty is quantified by the variance or its inverse precision
the brain wighs predictionn errors by their precision
if certain sensory signals are noisy or correlated the precision adn the covariance matrix plays a central role in updating beliefs.
Hierarchical models, rater tgan assume independence the model captures the covariance structure between these factors. The brain might learn these covariance patterns through experience effectively tuning iits priors.

Conditional independence
IF we have two variables independent on another event c and they dont intersect based on c. Then they are independent. In physical words, if the elements are not interrelated within oir deficniont of the syste, , then tehy are independent. So independence depends on what the system encompass.

Multi-variate gaussian distributions
The brain wirghs prediction werrrs by theirreciioson. If certain sensory signals are noisy or correlated the precision plays a centra role un pudating beliefs

Approximate Inference:
The brain likely uses approximate methods (such as sampling or variational inference) to compute posterior distributions. These methods naturally incorporate the full covariance structure of the underlying distributions. For example, if the brain is ‚Äúsampling‚Äù from a multivariate Gaussian that represents its belief about a scene, those samples will reflect the covariances among features.

multi-variate gaussian  
More elements

Reactions
Reactions come from sensorial data. In order to have a fully automatic agent, we need to define reactions and have a way to compute them. Here we will introduce statistical quality control and control charts. These are going to determine alerts and make the Aicon to recompute priors and posteriors to determine actions.

Continuous Relaxation (Discrete Vars)
Treat each hypothesis as an independent Bayesian update

How Ad performance fluctuated due to random effects.

LLM data into pseudo data.
Usually, Bayes Factors compare real empirical data. But here, we treat the LLM‚Äôs confidence or rhetorical strength as if it were ‚Äúpseudo-evidence,‚Äù letting us quantify how persuasive the LLM is about
ùêª
H.

Practical, first we let the llm ‚Äúcontinues the completion‚Äù then we feed that completion or thought to the tool bayes_factor_generation.

Extrinsic goals and constraints:
Shaping the Utility Function:
The utility function can explicitly include terms for external objectives. For example, a marketing analyst might define:

ùëà
(Ad) = Expected Revenue ‚àí Cost + ùúÜ ‚ãÖ Brand Impact,
U(Ad)=Expected Revenue‚àíCost+Œª‚ãÖBrand Impact,
where ùúÜ
Œª adjusts the weight of long-term brand value‚Äîa goal imposed by the company.

Constraints and Feasible Action Space:
Extrinsic goals may also limit the action space. In a company, you might not have the option to pursue strategies that are too risky or deviate from the brand‚Äôs identity. This means the set of actions
ùê¥
A is defined not only by what is physically or technically possible but also by organizational or regulatory constraints.

Higher-Level Priors:
In the Bayesian brain view, our brain‚Äôs expectations or higher-level goals can act like ‚Äúhyperpriors‚Äù that bias lower-level decision processes. For example, if your company prioritizes sustainability, that extrinsic goal might bias your neural decision processes (via learned reward signals) toward choices that are more eco-friendly, even if those choices might seem suboptimal from a narrow profit perspective.

Statistical Quality Control

Continuous factors
In the application of the Bayesian brain hypothesis, we define a prediction of continuous factors.

Confidence in Monte Carlo Simulations
Confidence can be a parameter fro uncertainty of the system. MIT 6. MOnte carlos siualtion; typically our best guess is what weve seen. But we really should not have ery cmcuh confidence in that guess. Coula have been just an acciednt.

Variance is the important factor here. As variance grows we need larger samples to have the same amount of confidence.

Now applied to aicon.

Standar deviations ponders quite highly outliers. So an error which happens to humans as well is to undewrsand when an outlier should be included in the data. TH eporblem with outliers is that they also could be errors happening duing data capture. So outlier detection and diagnosis should also be a critical part of our aicon system.

ASSUMPTIONS:
Confidence intervals, empirical rule, work if there is nor bias and also if the distribution of the errors in estimates is normal.

pmf and pdf.

Using Tools
For the Aicon to complete the decisions we can make the tools in different ways. We can make
Examples
Break
For a marketing company, the first prototype of decision making is in digital ads campaigns in Meta. We started with meta as they define clearly what objectives mean in a campaign so that the data they track is towards understanding how different campaigns are doing based on the objective. They also have a great api so that we can give the Aicon the tool to post the ads.

The use case:
Right now we are using our bayesian brain so that it is integrated into an already ongoing campaign. This already have ads and historic data of ad performance. This way we could measure the optimization technique of the bayesbrain ads skill.

In order to determine how the aicon is going to be run, we need to see what action space is shaped.

What do we want the Aicon to decide from?
Allocate budget daily for each ads campaign.
The optima job of the Aicon is to take time as infinite projected time. We could decide this because the decision of taking some step S in the near future t + 1; could eb less optimal that taking step S in later future t + 100; when t is measured in days. But for simplicity of analysis and using a pragmatic point of view instead of a philosophical, we define also a time frame. (Disclaimer, everything should be able to be generated entirely from Aicon; but more on this later)
Tests
Metrics to understand if this system works properly.

References
https://www.youtube.com/watch?v=OgO1gpXSUzU&t=1988s

https://www.youtube.com/watch?v=8wVq5aGzSqY
